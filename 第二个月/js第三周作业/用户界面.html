<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
<style>
/*这个事例用事件委托,由于事件委托只能找到最顶端的元素 父元素找不到  所以最顶端的元素class=="up"起到判断的作用 up这个classname不设样式  能停留显示的元素的classname都是up; 这些元素设样式时用标签名设样式
还有就是删除延器的位置对用户交互体验非常重要
用setAttribute设置自定义属性  需要注意的是数据的类型是string 需要用到的时候parseInt*/



*{margin:0px;padding:0px;font-size:0px;}
.wrap{padding-top:50px;padding-left:50px;}

ul{list-style:none;}

li{margin-bottom:40px;width:500px;height:200px;background:#e98758;}

li span {width:80px;height:80px;border-radius:50%;overflow:hidden;float:left;margin:10px 0px 0px 10px;display:block;}
img{width:100%;}
.pop{width:300px;height:150px;position:absolute;left:200px;top:10px;background:red;display:none;}
.top{height:50%;background:url(images/010_m.jpg) no-repeat;background-size:cover;text-align:center;}

.bot{height:50%;background:#fff;text-align:center;}

.pop .pic{width:40px;height:40px;border-radius:50%;display:inline-block;margin-top:50px;overflow:hidden;}
.pop h3{font-size:12px;line-height:46px;}
.pop p{font-size:11px;line-height:20px;margin-top:-16px;}

</style>

<script>
//事件委托找的事件源只能是最上面的元素  下层被覆盖的父元素是找不到的
//点击头像 延迟0.5秒出现弹窗  如果鼠标滑到或者头像弹窗并一直停留 弹窗不会消失  也不会出现弹窗闪烁  
//只要就0.5秒里从头像或者弹窗滑到 非停留显示区又滑回来 弹窗不会显示 也不会闪烁  这是很重要的用户交互体验 
window.onload=function(){
	arr=[	
			{"name":"小熊猫","profile":"简介：别问了 不能养"},
			{"name":"网易云音乐","profile":"简介：网易云音乐官方微博"},
			{"name":"使徒子","profile":"简介：漫画家、景观设计师、代表作《脑洞我个超市》《一条狗》 微博签约自媒体"},
			{"name":"小野妹子学吐槽","profile":"简介：微博知名博主"},
			{"name":"新浪官方微博","profile":"简介：新浪官方微博"},
			{"name":"沧月","profile":"简介：畅销书作者，兼三流的建筑师。擅写幻想类小说。作品包括《羽》《镜》《听雪楼》《七夜雪》"}
	]
	
	var ul=document.getElementsByTagName("ul")[0];
	//只要结构中有些pop 即使display=none 也可以从document中得到
	var Opop=document.getElementsByClassName("pop")[0];
	//alert(Opop)
	var aImg=document.getElementsByTagName("img");
	var wrap=document.getElementsByClassName("wrap")[0];
	
		for(var i=0;i<arr.length;i++){
			var li=document.createElement("li");
			li.innerHTML='<span><img class="up" src="images/'+(i+13)+'.jpg"></span>';
			li.setAttribute("index",i);
			ul.appendChild(li);
		}
		
		
		var appear=null;
		var disappear=null;
		//onmousemove是一个循环事件 只要鼠标在移动 里面的语句就不断执行
		wrap.onmousemove=function(ev){
			ev=ev||event;
			//事件源  w3c:鼠标的目标   IE:鼠标的源元素
			var evsrc=ev.target||ev.srcElement;
			
			
			
			//如果事件源不是所需要的元素 这里的if相当于进入一个元素的事件
			if((evsrc.className!="up")&&(evsrc.className!="pop up")){
				clearTimeout(appear)
				//下面删除延时器的位置很重要  在头像和头像外面晃  删除延时器写在延时器里面，那么 要隔1秒才执行 而延时器不断累加 1s后删除延时器才开始    
				clearTimeout(disappear)	;				
				disappear=setTimeout(function(){
									
				Opop.style.display="none";
				},500)
			}
			
			//儿子在父亲的上面 只能找img img100%span　不能找span
			if(evsrc.className=="up"){
					
				clearTimeout(disappear)	;
			//下面的删除延时器的位置很重要 但鼠标在相隔一个头像移动时 如果删除延时器写在延时器
		//里面 那么会延迟1秒钟再执行 
		//总结 为了更好的用户交互体验 删除延时器的位置很重要
				clearTimeout(appear);
			//alert(typeof(evsrc.parentNode.parentNode.getAttribute("index")))
				appear=setTimeout(function(){
					Opop.innerHTML=
					'<div class="top">'+
						'<div class="up">'+
    					'<div class="pic"><img class="up" src="images/'+(parseInt(evsrc.parentNode.parentNode.getAttribute("index"))+13)+'.jpg"></div>'+
						'</div>'+
    				'</div>'+
					'<div class="bot">'+
					'<div class="up">'+
						'<h3 class="up">'+arr[parseInt(evsrc.parentNode.parentNode.getAttribute("index"))].name+'</h3>'+
						'<p class="up">'+arr[parseInt(evsrc.parentNode.parentNode.getAttribute("index"))].profile+'</p>'
					'<div class="up">'+
					'</div>'			
					Opop.style.display="block";
					Opop.style.top=evsrc.offsetTop+"px";
					var a=evsrc
					return a;			
				},500)
			}
			
		/*	if(evsrc.className=="pop up"){	
				clearTimeout(disappear)	;
				clearTimeout(appear)
				console.log(disappear)
				//appear会运行一次 并且返回a的值  所以这里不用写Opop.style.display="block";
				Opop.style.top=appear.offsetTop+"px";
			}*/
		}

}

</script>
</head>

<body>
<div class="wrap">
<span class="pop up">
<!--	<div class="top">
          <div class="up"> up起到开关的作用
          <div class="pic"><img src="images/13.jpg"></div>
          </div>
    </div>
    <div class="bot">
    	<div class="up">
          <h3>小熊猫</h3>
          <p>简介</p>
        </div>
    </div>-->
</span>
	<ul>
<!--    	<li>
        	<span><img src="images/13.jpg"></span>
       	</li>
        
        <li>
        	<span><img src="images/14.jpg"></span>
       	</li>
		
        <li>
        	<span><img src="images/15.jpg"></span>
       	</li>
        
        <li>
        	<span><img src="images/16.jpg"></span>
       	</li>
        
        <li>
        	<span><img src="images/17.jpg"></span>
       	</li>
     	
        <li>
        	<span><img src="images/18.jpg"></span>
       	</li>-->
        
    </ul>
</div>

</body>
</html>

