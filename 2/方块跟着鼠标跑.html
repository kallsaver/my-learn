<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>无标题文档</title>
<style type="text/css">
*{margin:0;padding:0;}
p{width:600px;}
.box{width:200px;height:200px;background:red;position:absolute;}


</style>
<script>
window.onload=function(){
	var box=document.getElementsByClassName("box")[0];
	var input=document.getElementsByTagName("input")[0];
	
	
	//子元素的事件必须和父元素的事件相同,才能实现阻止冒泡的效果
	input.onmousedown=function(ev){
		var oEv=ev||window.event;
		
		//阻止冒泡 不然input框无法输入内容
		oEv.cancelBubble=true;
	
	}
	
	box.onmousedown=function(ev){
		//记录偏移量  减去这个偏移量 不然鼠标会始终在方块的左上角;
		var oEv=ev||window.event;
		var disX=oEv.clientX-this.offsetLeft;
		var disY=oEv.clientY-this.offsetTop;
		var w=this.offsetWidth;
		var h=this.offsetHeight;
		var screenW=document.documentElement.clientWidth;
		var screenH=document.documentElement.clientHeight;
		
			
				
			document.onmousemove=function(ev){
					var oEv=ev||window.event;
					//oEv.clientX是指鼠标的x轴坐标,是number类型的变量;
					var l=oEv.clientX;
					var t=oEv.clientY;
					
					
					//行内样式有width和height,js才可以获得样式的数据,数据类型为string,js无法获取行外样式,但是js可以用offsetWidth获得div的宽度,offsetWidth的数据类型是number,是系统算出来的;
					//var w=parseInt(box.style.width);	
					//var h=parseInt(box.style.height);
					box.style.left=l-disX+"px";
					box.style.top=t-disY+"px";
					
					//这里的if要写在后面判断,是因为后面的会把前面的冲点,如果if写在前面,等于没写
					
					//这里的if不用嵌套判断,嵌套判断会卡,因为每执行一次,都要执行if里面的内容一次
					
					//而这里的结构,只有满足if的条件,才会执行if里面的内容,所以动画效果流畅
					
					if(l-disX<0){
						box.style.left=0+"px";
						
					}
					
					
					if(l-disX+w>screenW){
						box.style.left=screenW-w+"px";
					}
					
					if(t-disY<0){
						box.style.top=0+"px";
					}
					
					if(t-disY+h>screenH){
						box.style.top=screenH-h+"px";
					}
					
					
			}
			//这里用document    以下代码放外面一层也可以实现
			
			//松开鼠标 onmousemove不再有效 否则松开鼠标 鼠标依然在方块上 onmousemove有效
			document.onmouseup=function(){
				document.onmousemove=null;
			}
		
		//onmousedown要阻止默认事件 
		return false;
		
	}

}

</script>
</head>

<body>
<div class="box" style="width:200px;height:200px;">
	
	<input type="text">
</div>
</body>
</html>
