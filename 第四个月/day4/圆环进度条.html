<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
		<canvas id="canvas" width="250" height="250"></canvas>
	</body>
	<script type="text/javascript">
		window.onload = function(){
     //canvas initialization
     var canvas = document.getElementById("canvas");
     var ctx = canvas.getContext("2d");
     //dimensions
     var W = canvas.width;
     var H = canvas.height;
     //Variables
     var degrees = 0;
     var new_degrees = 0;
     var difference = 0;
     var color = "green"; //green looks better to me
     var bgcolor = "#E8E8E8";
     var text;
     var animation_loop, redraw_loop;
     
     function init()
     {
         //Clear the canvas everytime a chart is drawn
         ctx.clearRect(0, 0, W, H);
         
         //Background 360 degree arc
         ctx.beginPath();
         ctx.strokeStyle = bgcolor;
         ctx.lineWidth = 10;    //预填充环的宽度
         ctx.arc(W/2, H/2, 100, 0, Math.PI*2, false); //you can see the arc now
         ctx.stroke();
         
         //gauge will be a simple arc
         //Angle in radians = angle in degrees * PI / 180
         var radians = degrees * Math.PI / 180;
         ctx.beginPath();
         ctx.strokeStyle = color;
        ctx.lineWidth = 10;    //填充环的宽度
         //The arc starts from the rightmost end. If we deduct 90 degrees from the angles
         //the arc will start from the topmost end
         ctx.arc(W/2, H/2, 100, 0 - 90*Math.PI/180, radians - 90*Math.PI/180, false); 
         //you can see the arc now
         ctx.stroke();
         
         //Lets add the text
         ctx.fillStyle = color;
         ctx.font = "20px bebas";
         text = Math.floor(degrees/360*100) + "%";
         //Lets center the text
         //deducting half of text width from position x
         text_width = ctx.measureText(text).width;
         //adding manual value to position y since the height of the text cannot
         //be measured easily. There are hacks but we will keep it manual for now.
         ctx.fillText(text, W/2 - text_width/2, H/2 + 15);
     }
     
     function draw()
     {
         //Cancel any movement animation if a new chart is requested
         if(typeof animation_loop != undefined) clearInterval(animation_loop);
         new_degrees=new_degrees+1;
         difference = new_degrees - degrees;
         animate_to();
     }
     
     //function to make the chart move to new degrees
     function animate_to()
     {
         //clear animation loop if degrees reaches to new_degrees
         if(degrees == new_degrees) 
             clearInterval(animation_loop);
         
         if(degrees==360)//如果加载到了360度，就停止
             return;
         
         if(degrees < new_degrees){
         	degrees++;
         } 
         else{
         	degrees--;
         }  
         init();
     }
     
     //调用各个函数，实现动态效果
     draw();
     redraw_loop = setInterval(draw, 10); //Draw a new chart every 2 seconds
    
 }
	</script>
</html>