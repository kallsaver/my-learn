<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
  </head>
  <body>

  </body>
  <script type="text/javascript">

    //ES5的做法:
    function run(x,y){
      y = y || 'World';
      console.log(x,y);
    }

    //这种做法有缺陷,当y的实参是0或者false的时候,输出的是默认值
    run(100,2);       //100,2
    run(100);        //100,'World'
    run(100,0);      //100,'World'
    run(100,false);  //100,'World'

    //所以更准确的做法是:

    function run1(x,y){
      if(typeof y === 'undefined'){
        y = 'World';
      }
      console.log(x,y);
    }

    run1(100,2);      //100,'World'
    run1(100);        //100,'World'
    run1(100,0);      //100,0
    run1(100,false);  //100,false


    //ES6可以直接为参数设置默认值

    function getY(x,y='world'){
        console.log(x,y);
    }

    getY(100,2);      //100,'World'
    getY(100);        //100,'World'
    getY(100,0);      //100,0
    getY(100,false);  //100,false

    //参数也是可以解构的

    function foo({x,y=5}){
      console.log(x,y)
    }

    foo({x:1});
    foo({x:1,y:2});

    //函数的length属性
    //返回没有指定默认值的参数的个数
    console.log('函数的length',(function(a){}).length)
    console.log((function(a,b=5){}).length)
    console.log((function(a,b){}).length)

    //参数默认值,即'='号右边的变量是外部的变量
    let x = 100;
    function f (y = x){
      let x = 2;
      console.log(y)
    }

    f();

    let str = 'outer';
    //注意这里的fn = () => str不是function fn(){return str}的意思
    //而是 fn = function(){return str},fn是形参,=号右边是默认值
    //而=号右边的东西是外部的作用域,主函数和回调函数是兄弟函数关系,所以str='outer'
    function bar(fn = () => str){
      let str = 'inner';
      console.log(fn())
    };

    bar();   //outer


    function k(fn){
      let str = 'inner';
      console.log(fn());
    }

    k(()=>str);

    //经典的ES5主函数和回调函数是兄弟函数关系,回调函数虽然是运行在主函数内部
    //但是作用域是声明时的作用域,不是运行时的作用域
    function father(){
      let str = 'father';
      function p(fn){
        let str = 'inner';
        fn();
      }

      p(function(){
        console.log(str)    //outer
      })
    }

    father();

    //利用参数默认值,可以指定某一个参数不得省略,如果省略就抛出一个错误

    function throwIfMissing(){
      console.log('必须有参数');
      throw new Error('Missing paramter');
    }

    function dosome(mustHave = throwIfMissing()){
        //写一些代码

    }
    //可以看到如果有输入参数,throwIfMissing()就不会执行了,也就是惰性执行
    dosome(1);


  </script>
</html>
