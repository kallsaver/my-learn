<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>
	<body>
	</body>
		<script>
		//angular的结构:主次模块是兄弟函数  顶级控制器是次级控制器的父级函数
		//angular的factory不是通常的工厂模式  它除了var cart return cart  还是个自运行函数并且赋值给一个全局变量了
		//所以var 除了的cart的生命周期是无限长的
	//angular中的主模板和次模板的factory的结构应该是这样的:   
	
	
	function zhumokuai(fn){				//cart的地址被引用了
		
		
		function controller1(){			//cart相对于两个controller是全局函数  所有controller1结束cart的生命周期还没结束

			var a={"name":"aa"}
			fn.findAll().push(a)      	//cart的地址被引用了并加了内容  
		}
		
		function controller2(){			//cart相对于两个controller是全局函数	所有controller1结束cart的生命周期还没结束
			var a={"name":"bb"}
			fn.findAll().push(a)			
		}
		controller1()
		controller2()
		console.log(fn.findAll())
		
										//函数结束 然而a是window全局变量   cart的地址被它引用  直到浏览器关闭a的内存才会被垃圾机制回收
	}
	
	var a=(function cimokuaifactory(){		//cart的地址被闭包引用了  所以cart在自运行函数结束的时候没有销毁
		var cart=[];
		return {
			
			add:function(a){
				cart.push(a)				//a是add函数的私有变量 因为a被cart引用了 所以a的生命周期取决于cart
			},
			
			findAll:function(){
				return cart;
			}
				
		}
	})()
	
	//注入
	zhumokuai(a)		
			
			
			
		</script>
	
</html>
