<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			ul{list-style: none;}
		</style>
		<script src="js/angular.js"></script>
		<script>
			angular.module("myApp",[],function(){
				
			})
			
			.directive('bookList',function(){
				return {
					restrict : "ECAM",
					replace : true,
					controller : function($scope){
						$scope.bookList = [
							{name : 'php'},
							{name : 'javascript'},
							{name : 'python'},
						];
						this.addBook = function(){
							//alert(1)
							$scope.$apply(function(){
								$scope.bookList.push({name : 'Angularjs'})
							})
							
						}
					},
					controllerAs : "bookListCtrl",
					//template不能写成平行元素,必须有个root element即最外围的元素  否则link中的element就找不到匹配的元素
					template :'<div><ul><li ng-repeat="book in bookList">{{book.name}}</li></ul>'+
							'<div book-add></div></div>'
				}
			})
			
			.directive('bookAdd',function(){
				return {
					restrict : 'ECAM',
					template : '<button type="button">添加</button>',
					replace : true,
					//通过驼峰命名法指定控制器应该带哪一条指令
					//不写前缀符 表示默认找同一个元素上的指令  即找自己的controllerAs
					//^表示在父级DOM元素中找
					//?表示指令是可选的,如果找不到,不需要抛出移除
					//require写的是指令名
					require : '^bookList',
					//bookListCtrl是通过require规则找到的controllerAs的名字,注入
					//默认注入自己的controller
					link : function(scope,element,attr,bookListCtrl){
						//实例化bookListCtrl 这个对象下有addBook的方法
						element.on('click',bookListCtrl.addBook)
					}
				}
			})
			
			.controller("myCtrl",['$scope',function($scope){
				
			}])
			
		</script>
	</head>
	<body ng-app="myApp">
		<div ng-controller="myCtrl">
			<div book-list></div>
		</div>
	</body>
</html>
