<!DOCTYPE html>
<html ng-app="myApp">
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			*{margin:0;padding: 0;}
			div.box{
				width: 300px;height: 50px;background: peru;border-radius: 5px;
				color: #fff;text-align: center;line-height: 50px;margin-bottom: 40px;
			}
		</style>
	</head>
	<body ng-controller="myCtrl">
		<div class="box" ng-click="leap()">myCtrl</div>
		<ng-view></ng-view>
	</body>
	<script src="js/angular.js"></script>
	<script src="js/angular-route.min.js"></script>
	<script>
		//$location是用来读取数据的,是主模块的组件,$route是用来操作url地址和浏览器刷新的,是ngRoute模块的组件
		//如果controller要使用它,那么controller所在的模块要先注入ngRoute,
		//同理link要使用它,那么directive所在的模块也要先注入ngRoute
		//$routeParams在知道url参数的key的情况下专门读取params的(虽然使用$route,$location也能做到,但是比较麻烦),
		//而且$routeParams在管理ng-view控制器是在异步任务(拿到template)后执行,$routeParams也是在这时生效,
		//所以在其他的同步任务控制器中,如果不使用监听事件,使用$routeParams拿值会是undefined
		var other = angular.module('other',['ngRoute']);
		other.config(['$routeProvider',function($routeProvider){
			console.log('config执行');
			$routeProvider
			.when('/home/:page',{
      			templateUrl : 'views/home.html',
      			controller : 'navCtrl'
   			})
			.when('/product',{
      			templateUrl : 'views/product.html',
   			})
		}])
		//每次使用了$route.updateParams的controller都会重新执行一遍
		.controller('navCtrl',['$scope','$route','$routeParams',function($scope,$route,$routeParams){
			console.log('navCtrl执行');
			console.log($routeParams.page);
			$scope.currentPage = parseInt($routeParams.page);
			//url地址先生成=>路由拿到template页面=>ng-view页面渲染
			//url地址的page值=>$scope.currentPage=>$scope.currentPage++ =>url地址的page值=>url地址的page值
			//上面的过程循环
			$scope.run = function(page){     //传进来的是currentPage
				$scope.currentPage ++;
				$route.updateParams({
					page : $scope.currentPage
				})
			}
			
		}])
		
		var app = angular.module('myApp',['ngRoute','other']);
		app.config(['$routeProvider',function($routeProvider){
			$routeProvider.otherwise({redirectTo: '/home/1'});
		}])
		//这个模块因为没有在config中配置路由的参数,所以$routeParams是无法使用的
		.controller('myCtrl',['$scope','$location','$route','$routeParams',function($scope,$location,$route,$routeParams){
			console.log('myCtrl执行');
			//可以看到$location都是$$,这意味着$location是用来读取信息的
			console.log($location);
			//可以看到$route差不多都是方法,这意味着$route是用来操作url地址和浏览器的
			console.log($route);
			console.log($routeParams);
			console.log($routeParams.page);                     //undefined;
			$scope.leap = function(){
				//$location不知道参数的key的情况下可以得到想要的信息
				console.log($location.path());					//url#后面的字符串
				console.log($route.current.pathParams.page);    //1
				console.log($routeParams.page);                 //1
				//使用了$route的方法,ng-view的控制器要重新执行
				$route.reload();
			}
		}])
		
		
		
	</script>
</html>
