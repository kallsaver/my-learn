<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<script src="js/angular.js"></script>
	</head>
	<body>
		<div ng-app="Demo" ng-controller="demoCtrl">
			<my-div count="count"></my-div>{{count}}
		</div>
	</body>
	<script>
		//脏检查是angular的核心机制
		angular.module('Demo',[])
		
		.directive('myDiv',[function(){
			return {
				restrict : 'EACM',
				template : '<input type="button" value="click" />',
				scope: {
					//"="表示父controller中的$scope.count和指令的$scope.count是同一个指针
					count : '='
				},
				link : function(scope,element,attrs){
					element.bind('click',function(){
						scope.count ++ ;
						//没有脏检查,model中的数据改变了,但是view的数据还是不变,是不会刷新页面的
						//$apply用于异步操作,比如ajax请求,事件监听,$timeout这些
						scope.$apply();
					})
					//$watch是监控$scope下的数据,一旦改变就执行$watch的回调函数
					scope.$watch('count',function(){
						console.log('count改变了')
					})
				}
			}
			
		}])
		
		.controller('demoCtrl',['$scope',function($scope){
			$scope.count = 0;
		}])
		
		
	</script>
</html>
